<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Breath Hold Visual</title>
  <style>
    :root{
      --bg: #ffd400;          /* yellow background */
      --text: rgba(0,0,0,.92);
      --muted: rgba(0,0,0,.60);
      --ring: rgba(0,0,0,.35);
      --ringStrong: rgba(0,0,0,.75);
      --fill: rgba(0,0,0,.55); /* expanding inner circle */
      --btn: rgba(0,0,0,.90);
      --btnText: #ffffff;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      min-height:100svh;
      display:grid;
      place-items:center;
      padding:18px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .shell{
      width:min(520px, 100%);
      padding:18px 18px 16px;
      border-radius:22px;
      background: rgba(255,255,255,.16);
      border: 1px solid rgba(0,0,0,.10);
      box-shadow: 0 18px 50px rgba(0,0,0,.18);
      backdrop-filter: blur(6px);
    }

    .header{
      display:flex;
      justify-content:space-between;
      gap:12px;
      align-items:flex-start;
      margin-bottom:10px;
    }
    .title{
      margin:0;
      font-size:18px;
      font-weight:950;
      letter-spacing:.2px;
    }
    .subtitle{
      margin:6px 0 0;
      color: var(--muted);
      font-size:13px;
      line-height:1.35;
    }
    .badge{
      padding:8px 10px;
      border-radius:999px;
      background: rgba(0,0,0,.08);
      border: 1px solid rgba(0,0,0,.12);
      color: rgba(0,0,0,.75);
      font-weight:900;
      font-size:12px;
      white-space:nowrap;
    }

    .stage{
      display:grid;
      place-items:center;
      margin: 10px 0 12px;
    }

    .dial{
      width:min(390px, 84vw);
      aspect-ratio:1/1;
      position:relative;
      display:grid;
      place-items:center;
    }

    /* Outer ring */
    .ring{
      position:absolute;
      inset: 0;
      border-radius: 999px;
      border: 12px solid var(--ring);
    }
    .ringStrong{
      position:absolute;
      inset: 0;
      border-radius: 999px;
      border: 12px solid var(--ringStrong);
      mask: radial-gradient(circle, transparent 62%, #000 63%);
      pointer-events:none;
      opacity:.35;
    }

    /* Expanding inner fill circle */
    .fill{
      width: 0%;
      height: 0%;
      border-radius: 999px;
      background: var(--fill);
    }

    .center{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      text-align:center;
      padding: 24px;
      pointer-events:none;
    }
    .label{
      font-size:46px;
      font-weight:1000;
      letter-spacing:.6px;
      text-transform: uppercase;
      line-height:1.05;
    }
    .timer{
      margin-top:10px;
      font-size:18px;
      font-weight:900;
      color: rgba(0,0,0,.65);
    }

    .controls{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top: 8px;
    }
    button{
      border:0;
      border-radius:14px;
      padding: 12px 16px;
      font-weight:950;
      cursor:pointer;
    }
    .start{
      background: var(--btn);
      color: var(--btnText);
      min-width: 140px;
    }
    .secondary{
      background: rgba(0,0,0,.08);
      color: rgba(0,0,0,.9);
      border: 1px solid rgba(0,0,0,.14);
    }
    button:disabled{ opacity:.55; cursor:not-allowed; }

    .status{
      margin-top:10px;
      min-height:20px;
      text-align:center;
      color: rgba(0,0,0,.65);
      font-size:13px;
    }

    .fineprint{
      margin-top: 12px;
      font-size: 12px;
      color: rgba(0,0,0,.55);
      line-height:1.35;
    }
  </style>
</head>

<body>
  <div class="shell">
    <div class="header">
      <div>
        <h1 class="title">Smoker / Vaper Lung Test</h1>
        <p class="subtitle">Tap Start once. 3s inhale â†’ hold while the circle fills.</p>
      </div>
      <div class="badge" id="phaseBadge">READY</div>
    </div>

    <div class="stage">
      <div class="dial">
        <div class="ring"></div>
        <div class="ringStrong"></div>
        <div class="fill" id="fill"></div>

        <div class="center">
          <div>
            <div class="label" id="label">Ready</div>
            <div class="timer" id="timer">0.0s</div>
          </div>
        </div>
      </div>
    </div>

    <div class="controls">
      <button class="start" id="startBtn">Start</button>
      <button class="secondary" id="resetBtn">Reset</button>
    </div>

    <div class="status" id="status"></div>

    <div class="fineprint">
      Safety: do this sitting down. Donâ€™t do breath-holds in water or while driving. Stop immediately if dizzy.
      For awareness/entertainment only â€” not a medical test.
    </div>
  </div>

<script>
  const startBtn = document.getElementById('startBtn');
  const resetBtn = document.getElementById('resetBtn');
  const fillEl   = document.getElementById('fill');
  const labelEl  = document.getElementById('label');
  const timerEl  = document.getElementById('timer');
  const statusEl = document.getElementById('status');
  const badgeEl  = document.getElementById('phaseBadge');

  const INHALE_MS = 3000;   // 3 seconds (per your request)
  const HOLD_MS   = 60000;  // 60 seconds to finish filling AFTER inhale

  let running = false;
  let raf = null;
  let startMs = 0;

  function setUIReady(){
    running = false;
    cancelAnimationFrame(raf);
    fillEl.style.width = "0%";
    fillEl.style.height = "0%";
    labelEl.textContent = "Ready";
    timerEl.textContent = "0.0s";
    statusEl.textContent = "";
    badgeEl.textContent = "READY";
    startBtn.disabled = false;
  }

  function format(s){ return `${s.toFixed(1)}s`; }

  function setFill(t){
    // Slightly under 100% so ring edge stays visible
    const size = 98 * t; // percent
    fillEl.style.width  = `${size}%`;
    fillEl.style.height = `${size}%`;
  }

  function tick(now){
    if(!running) return;

    const elapsed = now - startMs;

    // Total animation time = inhale + hold
    const totalMs = INHALE_MS + HOLD_MS;

    // Overall fill should begin immediately on start (visible during inhale)
    const totalT = Math.min(elapsed / totalMs, 1);
    setFill(totalT);

    // Phase labeling
    if(elapsed < INHALE_MS){
      badgeEl.textContent = "INHALE";
      labelEl.textContent = "Inhale ðŸ«";
    } else {
      badgeEl.textContent = "HOLD";
      labelEl.textContent = "Hold ðŸ«";
    }

    timerEl.textContent = format(elapsed / 1000);

    if(totalT >= 1){
      running = false;
      startBtn.disabled = false;
      badgeEl.textContent = "DONE";
      labelEl.textContent = "Done";
      statusEl.textContent = "Done. (Reset or Start again)";
      return;
    }

    raf = requestAnimationFrame(tick);
  }

  function start(){
    if(running) return;
    running = true;
    startBtn.disabled = true;
    statusEl.textContent = "Tip: open full-screen for a cleaner screen recording.";
    startMs = performance.now();
    raf = requestAnimationFrame(tick);
  }

  startBtn.addEventListener('click', start);
  resetBtn.addEventListener('click', setUIReady);

  setUIReady();
</script>
</body>
</html>
